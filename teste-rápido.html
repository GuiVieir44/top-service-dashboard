<!DOCTYPE html>
<html>
<head>
    <title>Teste RÃ¡pido - Consulta Ponto</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        button { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; cursor: pointer; }
        select { padding: 5px; margin: 5px; }
        pre { background: #f0f0f0; padding: 10px; overflow: auto; max-height: 300px; }
    </style>
</head>
<body>
    <h1>ðŸ§ª Teste - Consulta de Ponto</h1>
    
    <button onclick="setupData()">1. Setup Dados de Teste</button>
    <button onclick="testInit()">2. Inicializar MÃ³dulo</button>
    <button onclick="checkSelects()">3. Verificar Selects</button>
    <button onclick="clearData()">4. Limpar localStorage</button>
    
    <h2>Departamento:</h2>
    <select id="punch-query-department-filter">
        <option>-- Selecione departamento --</option>
    </select>
    
    <h2>FuncionÃ¡rio:</h2>
    <select id="punch-query-employee-select">
        <option>-- Selecione funcionÃ¡rio --</option>
    </select>
    
    <h2>Log:</h2>
    <pre id="log"></pre>
    
    <script>
        const log = (msg) => {
            const pre = document.getElementById('log');
            pre.textContent += msg + '\n';
            console.log(msg);
        };
        
        const clearLog = () => {
            document.getElementById('log').textContent = '';
        };
        
        const setupData = () => {
            clearLog();
            log('ðŸ“ Criando dados de teste...');
            
            const employees = [
                { id: 1, matricula: "MAT001", nome: "Ana Silva", departamento: "CondomÃ­nio A" },
                { id: 2, matricula: "MAT002", nome: "Bruno Santos", departamento: "CondomÃ­nio A" },
                { id: 3, matricula: "MAT003", nome: "Carlos Oliveira", departamento: "CondomÃ­nio B" },
                { id: 4, matricula: "MAT004", nome: "Diana Martins", departamento: "CondomÃ­nio B" }
            ];
            
            localStorage.setItem('topservice_employees_v1', JSON.stringify(employees));
            // NÃ£o salvamos departamentos para testar fallback
            log(`âœ… ${employees.length} funcionÃ¡rios criados`);
            log('âœ… localStorage.setItem("topservice_employees_v1", ...)');
            log('âš ï¸  Departamentos NÃƒO foram salvos (para testar fallback)');
        };
        
        const testInit = () => {
            clearLog();
            log('ðŸš€ Testando initPunchQueryModule()...');
            
            if (typeof initPunchQueryModule === 'function') {
                log('âœ… FunÃ§Ã£o initPunchQueryModule encontrada!');
                initPunchQueryModule();
                log('âœ… initPunchQueryModule() executada');
                
                setTimeout(() => checkSelects(), 100);
            } else {
                log('âŒ FunÃ§Ã£o initPunchQueryModule NÃƒO encontrada!');
            }
        };
        
        const checkSelects = () => {
            clearLog();
            log('ðŸ” Verificando selects...\n');
            
            const empSelect = document.getElementById('punch-query-employee-select');
            const deptSelect = document.getElementById('punch-query-department-filter');
            
            log(`FuncionÃ¡rio Select: ${empSelect ? 'âœ… Encontrado' : 'âŒ NÃ£o encontrado'}`);
            if (empSelect) {
                log(`  - Options: ${empSelect.options.length}`);
                log(`  - ConteÃºdo: ${empSelect.innerHTML.substring(0, 100)}...`);
            }
            
            log(`\nDepartamento Select: ${deptSelect ? 'âœ… Encontrado' : 'âŒ NÃ£o encontrado'}`);
            if (deptSelect) {
                log(`  - Options: ${deptSelect.options.length}`);
                log(`  - ConteÃºdo: ${deptSelect.innerHTML.substring(0, 100)}...`);
            }
        };
        
        const clearData = () => {
            clearLog();
            localStorage.clear();
            log('âœ… localStorage.clear() executado');
            document.getElementById('punch-query-employee-select').innerHTML = '<option>-- Selecione funcionÃ¡rio --</option>';
            document.getElementById('punch-query-department-filter').innerHTML = '<option>-- Selecione departamento --</option>';
        };
    </script>
    
    <!-- Incluir a funÃ§Ã£o necessÃ¡ria -->
    <script src="scripts/consulta-ponto.js"></script>
</body>
</html>
